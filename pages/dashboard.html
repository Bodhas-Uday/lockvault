<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - LockVault Password Manager</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon.ico">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-shield-alt"></i>
                <span>LockVault</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="../index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="about.html" class="nav-link">About</a>
                </li>
                <li class="nav-item">
                    <a href="features.html" class="nav-link">Features</a>
                </li>
                <li class="nav-item">
                    <a href="dashboard.html" class="nav-link active">Dashboard</a>
                </li>
                <li class="nav-item">
                    <a href="generator.html" class="nav-link">Generator</a>
                </li>
                <li class="nav-item">
                    <a href="profile.html" class="nav-link">Profile</a>
                </li>
                <li class="nav-item">
                    <a href="contact.html" class="nav-link">Contact</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Dashboard Section -->
    <section class="dashboard-container">
        <div class="container">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div>
                    <h1 class="dashboard-title">Password Dashboard</h1>
                    <p style="color: var(--text-secondary); margin-top: 10px;">
                        Welcome back! Manage your passwords securely.
                    </p>
                </div>
                <div class="dashboard-actions">
                    <a href="add.html" class="btn btn-primary">
                        <i class="fas fa-plus"></i>
                        Add Password
                    </a>
                    <a href="generator.html" class="btn btn-secondary">
                        <i class="fas fa-key"></i>
                        Generate Password
                    </a>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
                <div class="stat-card" style="background: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); text-align: center;">
                    <div style="font-size: 2rem; color: var(--primary-color); margin-bottom: 10px;">
                        <i class="fas fa-key"></i>
                    </div>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px;" id="total-passwords">0</div>
                    <div style="color: var(--text-secondary);">Total Passwords</div>
                </div>
                <div class="stat-card" style="background: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); text-align: center;">
                    <div style="font-size: 2rem; color: var(--success-color); margin-bottom: 10px;">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px;" id="strong-passwords">0</div>
                    <div style="color: var(--text-secondary);">Strong Passwords</div>
                </div>
                <div class="stat-card" style="background: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); text-align: center;">
                    <div style="font-size: 2rem; color: var(--warning-color); margin-bottom: 10px;">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px;" id="weak-passwords">0</div>
                    <div style="color: var(--text-secondary);">Weak Passwords</div>
                </div>
                <div class="stat-card" style="background: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); text-align: center;">
                    <div style="font-size: 2rem; color: var(--accent-color); margin-bottom: 10px;">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div style="font-size: 2rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px;" id="recent-passwords">0</div>
                    <div style="color: var(--text-secondary);">Added This Week</div>
                </div>
            </div>

            <!-- Search and Filter -->
            <div class="search-filter" style="background: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); margin-bottom: 30px;">
                <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 250px;">
                        <div style="position: relative;">
                            <input type="text" id="search-passwords" placeholder="Search passwords..." 
                                   style="width: 100%; padding: 15px 45px 15px 15px; border: 2px solid var(--border-color); border-radius: 10px; background: var(--dark-bg); color: var(--text-primary); font-size: 1rem;">
                            <i class="fas fa-search" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted);"></i>
                        </div>
                    </div>
                    <div>
                        <select id="filter-passwords" style="padding: 15px; border: 2px solid var(--border-color); border-radius: 10px; background: var(--dark-bg); color: var(--text-primary); font-size: 1rem;">
                            <option value="all">All Passwords</option>
                            <option value="strong">Strong Passwords</option>
                            <option value="weak">Weak Passwords</option>
                            <option value="recent">Recently Added</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Passwords Grid -->
            <div class="passwords-section">
                <div class="passwords-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <h2 style="font-size: 1.5rem; font-weight: 600; color: var(--text-primary);">Your Passwords</h2>
                    <div class="view-toggle" style="display: flex; background: var(--dark-bg); border-radius: 10px; padding: 5px;">
                        <button class="view-btn active" data-view="grid" style="padding: 10px 15px; border: none; background: var(--primary-color); color: white; border-radius: 8px; cursor: pointer; font-size: 0.9rem;">
                            <i class="fas fa-th"></i>
                        </button>
                        <button class="view-btn" data-view="list" style="padding: 10px 15px; border: none; background: transparent; color: var(--text-secondary); border-radius: 8px; cursor: pointer; font-size: 0.9rem;">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>
                <div class="passwords-grid" id="passwords-container">
                    <!-- Passwords will be loaded here by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Password Modal -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Password Details</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Password details will be loaded here -->
            </div>
            <div class="modal-footer" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                <button class="btn btn-secondary" id="copyPassword">
                    <i class="fas fa-copy"></i>
                    Copy Password
                </button>
                <button class="btn btn-primary" id="editPassword">
                    <i class="fas fa-edit"></i>
                    Edit
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <i class="fas fa-shield-alt"></i>
                        <span>LockVault</span>
                    </div>
                    <p>Your trusted partner in digital security.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="about.html">About</a></li>
                        <li><a href="features.html">Features</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Account</h4>
                    <ul>
                        <li><a href="register.html">Register</a></li>
                        <li><a href="login.html">Login</a></li>
                        <li><a href="profile.html">Profile</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Security</h4>
                    <ul>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="#">Security</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 LockVault. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="../assets/js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Update dashboard stats
            updateDashboardStats();
            
            // Setup search functionality
            const searchInput = document.getElementById('search-passwords');
            const filterSelect = document.getElementById('filter-passwords');
            
            searchInput.addEventListener('input', filterPasswords);
            filterSelect.addEventListener('change', filterPasswords);
            
            // Setup view toggle
            const viewButtons = document.querySelectorAll('.view-btn');
            viewButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    viewButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    toggleView(this.dataset.view);
                });
            });
            
            // Setup modal
            setupPasswordModal();
        });

        function updateDashboardStats() {
            const passwords = lockVault.passwords;
            const totalPasswords = passwords.length;
            const strongPasswords = passwords.filter(p => {
                const decrypted = lockVault.decryptPassword(p.password);
                return lockVault.getPasswordStrength(decrypted).level === 'strong';
            }).length;
            const weakPasswords = passwords.filter(p => {
                const decrypted = lockVault.decryptPassword(p.password);
                return lockVault.getPasswordStrength(decrypted).level === 'weak';
            }).length;
            
            const oneWeekAgo = new Date();
            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
            const recentPasswords = passwords.filter(p => new Date(p.createdAt) > oneWeekAgo).length;
            
            document.getElementById('total-passwords').textContent = totalPasswords;
            document.getElementById('strong-passwords').textContent = strongPasswords;
            document.getElementById('weak-passwords').textContent = weakPasswords;
            document.getElementById('recent-passwords').textContent = recentPasswords;
        }

        function filterPasswords() {
            const searchTerm = document.getElementById('search-passwords').value.toLowerCase();
            const filterValue = document.getElementById('filter-passwords').value;
            const passwords = lockVault.passwords;
            
            let filteredPasswords = passwords.filter(password => {
                const matchesSearch = password.website.toLowerCase().includes(searchTerm) ||
                                   password.username.toLowerCase().includes(searchTerm) ||
                                   (password.notes && password.notes.toLowerCase().includes(searchTerm));
                
                let matchesFilter = true;
                if (filterValue === 'strong') {
                    const decrypted = lockVault.decryptPassword(password.password);
                    matchesFilter = lockVault.getPasswordStrength(decrypted).level === 'strong';
                } else if (filterValue === 'weak') {
                    const decrypted = lockVault.decryptPassword(password.password);
                    matchesFilter = lockVault.getPasswordStrength(decrypted).level === 'weak';
                } else if (filterValue === 'recent') {
                    const oneWeekAgo = new Date();
                    oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                    matchesFilter = new Date(password.createdAt) > oneWeekAgo;
                }
                
                return matchesSearch && matchesFilter;
            });
            
            displayPasswords(filteredPasswords);
        }

        function displayPasswords(passwords) {
            const container = document.getElementById('passwords-container');
            
            if (passwords.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 60px 20px; color: var(--text-muted);">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <h3>No passwords found</h3>
                        <p>Try adjusting your search or filter criteria.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = passwords.map(password => {
                const decryptedPassword = lockVault.decryptPassword(password.password);
                const strength = lockVault.getPasswordStrength(decryptedPassword);
                
                return `
                    <div class="password-card" data-id="${password.id}">
                        <div class="password-card-header">
                            <div class="password-website">${password.website}</div>
                            <div class="password-actions">
                                <button class="action-btn view" onclick="viewPassword(${password.id})" title="View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="action-btn edit" onclick="editPassword(${password.id})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="action-btn delete" onclick="deletePassword(${password.id})" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="password-details">
                            <div class="password-detail">
                                <span class="password-label">Username:</span>
                                <span class="password-value">${password.username}</span>
                            </div>
                            <div class="password-detail">
                                <span class="password-label">Password:</span>
                                <span class="password-value hidden" id="password-${password.id}">••••••••</span>
                            </div>
                            ${password.notes ? `
                                <div class="password-detail">
                                    <span class="password-label">Notes:</span>
                                    <span class="password-value">${password.notes}</span>
                                </div>
                            ` : ''}
                            <div class="password-detail">
                                <span class="password-label">Strength:</span>
                                <span class="password-strength strength-${strength.level}">${strength.level.charAt(0).toUpperCase() + strength.level.slice(1)}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleView(view) {
            const container = document.getElementById('passwords-container');
            if (view === 'list') {
                container.style.gridTemplateColumns = '1fr';
            } else {
                container.style.gridTemplateColumns = 'repeat(auto-fill, minmax(350px, 1fr))';
            }
        }

        function setupPasswordModal() {
            const modal = document.getElementById('passwordModal');
            const closeBtn = document.querySelector('.close');
            const copyBtn = document.getElementById('copyPassword');
            const editBtn = document.getElementById('editPassword');
            
            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });
            
            window.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            copyBtn.addEventListener('click', () => {
                const password = copyBtn.getAttribute('data-password');
                lockVault.copyToClipboard(password);
            });
            
            editBtn.addEventListener('click', () => {
                const passwordId = editBtn.getAttribute('data-password-id');
                window.location.href = `edit.html?id=${passwordId}`;
            });
        }

        function viewPassword(id) {
            const password = lockVault.getPassword(id);
            if (!password) return;
            
            const modal = document.getElementById('passwordModal');
            const modalBody = document.getElementById('modalBody');
            const copyBtn = document.getElementById('copyPassword');
            const editBtn = document.getElementById('editPassword');
            
            modalBody.innerHTML = `
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: var(--text-secondary); margin-bottom: 5px;">Website:</label>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace;">${password.website}</div>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: var(--text-secondary); margin-bottom: 5px;">Username:</label>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace;">${password.username}</div>
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: var(--text-secondary); margin-bottom: 5px;">Password:</label>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; word-break: break-all;">${password.password}</div>
                </div>
                ${password.notes ? `
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text-secondary); margin-bottom: 5px;">Notes:</label>
                        <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px;">${password.notes}</div>
                    </div>
                ` : ''}
            `;
            
            copyBtn.setAttribute('data-password', password.password);
            editBtn.setAttribute('data-password-id', password.id);
            
            modal.style.display = 'block';
        }

        function editPassword(id) {
            window.location.href = `edit.html?id=${id}`;
        }

        function deletePassword(id) {
            lockVault.deletePassword(id);
            updateDashboardStats();
            filterPasswords();
        }

        // Initialize dashboard
        lockVault.updateDashboard();
        filterPasswords();
    </script>
</body>
</html>
